CREATE DATABASE BRANDS;

USE BRANDS;

CREATE TABLE ITEMS (
ITEM_ID INT NOT NULL,
ITEM_DESCRIPTION VARCHAR(200),
VENDOR_NOS INT,
VENDOR_NAME VARCHAR(200),
BOTTLE_SIZE INT,
BOTTLE_PRICE FLOAT(2)); 

INSERT INTO ITEMS VALUES(1,'Travis Hasse Apple Pie',305,'Mhw LTD',750,9.77)
INSERT INTO ITEMS VALUES(2,'D''aristi Xtabentun',391,'Anchor Distilling (preiss Imports)',750,14.12)
INSERT INTO ITEMS VALUES(3,'Hiram Walker Peach Brandy',370,'Pernod Ricard Usa/austin Nichols',1000,6.50)
INSERT INTO ITEMS VALUES(4,'Oak Cross Whisky',305,'Mhw Ltd',750,25.33)
INSERT INTO ITEMS VALUES(5,'Uv Red(cherry) Vodka',380,'Phillips Beverage Company',200,1.97)
INSERT INTO ITEMS VALUES(6,'Heaven Hill Old Style White Label',259,'Heaven Hill Distilleries Inc.',750,6.37)
INSERT INTO ITEMS VALUES(7,'Hyde Herbal Liqueur',194,'Fire Tail Brands Llc',750,5.06)
INSERT INTO ITEMS VALUES(8,'Dupont Calvados Fine Reserve',403,'Robert Kacher Selections',750,23.61);

SELECT * FROM ITEMS;

SELECT ITEM_DESCRIPTION FROM ITEMS
WHERE BOTTLE_SIZE = 750;

SELECT VENDOR_NAME FROM ITEMS
WHERE VENDOR_NOS IN (305,380,391);

SELECT SUM(BOTTLE_PRICE) FROM ITEMS;

ALTER TABLE ITEMS   
ADD CONSTRAINT PK_ITEM_ID PRIMARY KEY (ITEM_ID);

SELECT ITEM_ID FROM ITEMS
WHERE BOTTLE_PRICE = 5.06;

CREATE DATABASE PRODUCTS;

USE PRODUCTS;

CREATE TABLE PRODUCTS(
PRODUCT_ID INT,
COUNTRY VARCHAR(50),
PRODUCT VARCHAR(50),
UNIT_SOLD FLOAT(2),
MANUFACTURING_PRICE FLOAT(2),
SALE_PRICE FLOAT(2),
GROSS_SALES FLOAT(2),
SALES FLOAT(2),
COGS FLOAT(2),
PROFIT FLOAT(2),
DATE DATE,
MONTH_NUMBER INT,
MONTH_NAME VARCHAR(50),
YEAR INT);

INSERT INTO PRODUCTS VALUES(1,'Canada','Carretera',1618.5,3.00,20.00,32370.00,32370.00,16185.00,16185.00,'01-01-2014',1,'January',2014)
INSERT INTO PRODUCTS VALUES(2,'Germany','Carretera',1321,3.00,20.00,26420.00,26420.00,13210.00,13210.00,'01-01-2014',1,'January',2015)
INSERT INTO PRODUCTS VALUES(3,'France','Carretera',2178,3.00,15.00,32670.00,32670.00,21780.00,10890.00,'01-06-2014',6,'June',2016)
INSERT INTO PRODUCTS VALUES(4,'Germany','Carretera',888,3.00,15.00,13320.00,13320.00,8880.00,4440.00,'01-06-2014',6,'June',2017)
INSERT INTO PRODUCTS VALUES(5,'Mexico','Carretera',2470,3.00,15.00,37050.00,37050.00,24700.00,12350.00,'01-06-2014',6,'June',2018)
INSERT INTO PRODUCTS VALUES(6,'Germany','Carretera',1513,3.00,350.00,529550.00,529550.00,393380.00,136170.00,'01-12-2014',12,'December',2019)
INSERT INTO PRODUCTS VALUES(7,'Germany','Montana',921,5.00,15.00,13815.00,13815.00,9210.00,4605.00,'01-03-2014',3,'March',2020)
INSERT INTO PRODUCTS VALUES(8,'Canada','Montana',2518,5.00,12.00,30216.00,30216.00,7554.00,22662.00,'01-06-2014',6,'June',2021);

SELECT * FROM PRODUCTS;
 
DELETE FROM PRODUCTS
WHERE UNIT_SOLD IN (1618.5, 888, 2470);

SELECT SUM(SALE_PRICE) AS TOTAL_SALE_PRICE, SUM(GROSS_SALES) AS TOTAL_GROSS_SALES FROM PRODUCTS;

SELECT YEAR, SALES FROM PRODUCTS 
WHERE SALES = (SELECT MAX(SALES) FROM PRODUCTS);

SELECT PRODUCT FROM PRODUCTS 
WHERE SALES = 37050.00;

SELECT COUNTRY FROM PRODUCTS 
WHERE PROFIT BETWEEN 4605.00 AND 22662.00;

SELECT PRODUCT_ID FROM PRODUCTS
WHERE SALES = 24700.00;

SELECT TAB1.*,
TAB2.*
FROM [BRANDS].[dbo].[ITEMS] TAB1, [PRODUCTS].[dbo].[PRODUCTS] TAB2
WHERE TAB1.ITEM_ID = TAB2.PRODUCT_ID;

SELECT TAB1.*,
TAB2.*
FROM [BRANDS].[dbo].[ITEMS] TAB1
FULL OUTER JOIN [PRODUCTS].[dbo].[PRODUCTS] TAB2
ON TAB1.ITEM_ID = TAB2.PRODUCT_ID;

SELECT TAB1.*,
TAB2.*
FROM [BRANDS].[dbo].[ITEMS] TAB1
LEFT JOIN [PRODUCTS].[dbo].[PRODUCTS] TAB2
ON TAB1.ITEM_ID = TAB2.PRODUCT_ID;

SELECT TAB1.*,
TAB2.*
FROM [BRANDS].[dbo].[ITEMS] TAB1
RIGHT JOIN [PRODUCTS].[dbo].[PRODUCTS] TAB2
ON TAB1.ITEM_ID = TAB2.PRODUCT_ID;

SELECT TAB1.*,
TAB2.*
FROM [BRANDS].[dbo].[ITEMS] TAB1, [PRODUCTS].[dbo].[PRODUCTS] TAB2;

SELECT ITEM_DESCRIPTION, PRODUCT, GROSS_SALES FROM [BRANDS].[dbo].[ITEMS] TAB1
JOIN [PRODUCTS].[dbo].[PRODUCTS] TAB2
ON TAB1.ITEM_ID = TAB2.PRODUCT_ID
WHERE GROSS_SALES  = 13320;




